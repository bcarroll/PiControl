{%extends "base.html"%}
{%block title%}Locale{% endblock %}
{% block head %}
{% endblock %}
{%block body%}
<h1 class="page-header" id="page-header"><i class="fas fa-globe"></i> Localization</h1>
<div id="spinner" style="z-index: 9999;"><h1>Loading...</h1></div>
<div class="form-group">
    <form method="post" action="/locale/keyboard/update">
        <label for="XKBMODEL">Keyboard Model <i class="fas fa-question-circle" id="XKBMODEL_info"></i></label>
        <select id="XKBMODEL" class="form-control" name="XKBMODEL"></select>
        <br/>
        <label for="XKBLAYOUT">Keyboard Layout <i class="fas fa-question-circle" id="XKBLAYOUT_info"></i></label>
        <select id="XKBLAYOUT" class="form-control" name="XKBLAYOUT"></select>
        <br/>
        <label for="XKBVARIANT">Keyboard Variant <i class="fas fa-question-circle" id="XKBVARIANT_info"></i></label>
        <input id="XKBVARIANT" class="form-control" name="XKBVARIANT" value={{XKBVARIANT}}></input>
        <br/>
        <label for="XKBOPTIONS">Keyboard Options <i class="fas fa-question-circle" id="XKBOPTIONS_info"></i></label>
        <input id="XKBOPTIONS" class="form-control" name="XKBOPTIONS" value={{XKBOPTIONS}}></input>
        <br/>
        <label for="BACKSPACE">Keyboard Backspace/Delete <i class="fas fa-question-circle" id="BACKSPACE_info"></i></label>
        <input id="BACKSPACE" class="form-control" name="BACKSPACE" value={{BACKSPACE}}></input>
    </form>
</div>
<script>
    get_keyboard_config_data();
    function get_keyboard_config_data(){
        $.get('/locale/keyboard/configdata', function(result){
            console.log(result.xkbConfigRegistry);
            // parse list of available models
            for (i=0; i < result.xkbConfigRegistry.modelList.model.length; i++){
                name        = result.xkbConfigRegistry.modelList.model[i].configItem.name;
                description = result.xkbConfigRegistry.modelList.model[i].configItem.description;
                if ( name == "{{XKBMODEL}}"){
                    $('#XKBMODEL').append('<option value="' + name + '" selected="selected" title="' + description + '">' + name + '</option>');
                } else {
                    $('#XKBMODEL').append('<option value="' + name + '" title="' + description + '">' + name + '</option>');
                }
            }

            // parse list of available layouts
            for (i=0; i < result.xkbConfigRegistry.layoutList.layout.length; i++){
                name        = result.xkbConfigRegistry.layoutList.layout[i].configItem.name;
                description = result.xkbConfigRegistry.layoutList.layout[i].configItem.description;
                if ( name == "{{XKBLAYOUT}}"){
                    $('#XKBLAYOUT').append('<option value="' + name + '" selected="selected" title="' + description + '">' + name + '</option>');
                } else {
                    $('#XKBLAYOUT').append('<option value="' + name + '" title="' + description + '">' + name + '</option>');
                }
            }
            $('#spinner').toggle();
        });
    }
</script>
{%endblock%}
