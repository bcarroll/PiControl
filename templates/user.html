{%extends "base.html"%}
{%block title%}Users{% endblock %}

{%block body%}
<h1 class="page-header" id="page-header"><i class="fas fa-user"></i> Users</h1>
<button class="btn btn-primary" id="btn_show_users" onclick="toggle_users();">Show all users</button>
<br/>
<table class="table-responsive table-bordered table-hover" id="users">
    <tr>
        <th class="heading">Username</th><th class="heading">UID</th><th class="heading">Group</th><th class="heading">Home Directory</th><th class="heading">Shell</th>
    </tr>
</table>
<script>
    $.get('/users/get_all', function(result){
        for (user in result){
            if ( (result[user].shell == '/usr/sbin/nologin') || (result[user].shell == '/bin/false') || (result[user].shell == '/bin/sync' ) ){
                tr_class = 'inactive_user';
            } else {
                tr_class = 'active_user';
            }
            $('#users tr:last').after(
                                      '<tr class="' + tr_class + '">'
                                      + '<td>' + user + '</td>'
                                      + '<td>' + result[user].uid + '</td>'
                                      + '<td>' + result[user].group_name + '</td>'
                                      + '<td>' + result[user].home_dir + '</td>'
                                      + '<td>' + result[user].shell + '</td>'
                                      + '</tr>'
                                      );
            }
    });
    function toggle_users(){
        $('.inactive_user').toggle();
        if ( $('btn_show_users').text() == 'Show all users' ){
            $('btn_show_users').text() = 'Show users with a login shell';
        } else {
            $('btn_show_users').text() = 'Show all users';
        }
    }
</script>
{%endblock%}
